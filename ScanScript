# Subnet identifier for ping sweep
$subnet = "10.20.17"   #Enter 10.20.17.XX
 
# Host IP to start ping sweep
$start = 1
 
# Host IP to finish ping sweep
$end = 254
 
# Number of times to attempt each ping
$ping = 1
 
# Array to store Active Hosts
$ActiveIPs = @()

# Loop to check active hosts
While ($start -le $end) {
$IP = "$subnet.$start"
$Test = Test-Connection -ComputerName $IP -count $ping -Quiet
if ($Test -eq 'True') {
    $ActiveIPs += $IP
    }
$start++
}

# Loop to check if powershell remoting is enabled in active hosts
foreach ($i in $ActiveIPs) { 
if (Test-WSMan $i -ErrorAction SilentlyContinue) {
Write-host "$i"
}
}
